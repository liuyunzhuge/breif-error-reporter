!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(e=e||self).EventReporter=o()}(this,function(){"use strict";function a(e,o){return Object.prototype.toString.call(e)==="[object "+(o||"Object")+"]"}function e(e,o){var n,r,t;r=!1,(n=document.createElement("script")).type="text/javascript",n.src=e,n.onload=n.onreadystatechange=function(){r||this.readyState&&"complete"!==this.readyState||(r=!0,a(o,"Function")&&o())},(t=document.getElementsByTagName("script")[0]).parentNode.insertBefore(n,t)}function o(){}var s={RUNTIME:"runtime",RESOURCE:"resource",VUE:"vue",VUE_ROUTER:"vue-router",MANUAL:"manual",AXIOS:"axios"},u={vConsoleSrc:"//cdn.bootcss.com/vConsole/3.3.4/vconsole.min.js",maximumStackLines:20,resource:!0,vue:null,vueRouter:null,axios:null,processStack:function(e){var o=e.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,u.maximumStackLines).join("@").replace(/\?[^:]+/gi,""),n=""+e;return~o.indexOf(n)||(o=n+"@"+o),o},onReport:o,onResourceLoadError:o},r=null,t=[],c=!0,l={setConfig:function(e){var i;Object.assign(u,e),i=window.onerror,window.onerror=function(e,o,n,r,t){var c=e;return t&&t.stack&&(c=u.processStack(t)),~e.toLowerCase().indexOf("script error")?console.error("Script Error: See Browser Console for Detail"):u.onReport.call(l,c,s.RUNTIME),!!a(i,"Function")&&i.call(this,e,o,n,r,t)},u.resource&&window.addEventListener("error",function(e){if(e.target&&(e.target instanceof HTMLScriptElement||e.target instanceof HTMLLinkElement||e.target instanceof HTMLImageElement)){var o="--"+e.type+"--"+e.target.tagName.toLowerCase()+"::"+(e.target.src||e.target.href);u.onResourceLoadError.call(l,e),u.onReport.call(l,o,s.RESOURCE)}},!0),function(){if(u.vue){var r=u.vue.config.errorHandler;u.vue.config.errorHandler=function(e,o,n){return console.error(e),u.onReport.call(l,u.processStack(e),s.VUE),a(r,"Function")&&r(e,o,n)}}u.vueRouter&&u.vueRouter.onError(function(e){console.error(e),u.onReport.call(l,u.processStack(e),s.VUE_ROUTER)}),u.axios&&(u.axios.interceptors.request.use(function(e){return e},function(e){return console.error(e),u.onReport.call(l,u.processStack(e),s.AXIOS),Promise.reject(e)}),u.axios.interceptors.response.use(function(e){return e},function(e){return console.error(e),u.onReport.call(l,u.processStack(e),s.AXIOS),Promise.reject(e)}))}()},enableVConsole:function(n){if(r&&n)return function(){try{r&&r.show()}catch(e){}}();e(u.vConsoleSrc,function(){r=r||new VConsole({defaultPlugins:["system","network","element","storage"],maxLogNumber:5e3,onReady:function(){n&&setTimeout(function(){return r.show()},0)}}),c=!1;for(var e=t.length,o=0;o<e;o++)t[o].noOrigin=!0,r.pluginList.default.printLog(t[o]);t=[]})},loadScript:e,getSystemInfo:function(){var e=navigator.userAgent,o=e.match(/(ipod).*\s([\d_]+)/i),n=e.match(/(ipad).*\s([\d_]+)/i),r=e.match(/(iphone)\sos\s([\d_]+)/i),t=e.match(/(android)\s([\d\.]+)/i),c="Unknown",i="";t?(c="Android",i=t[2]):r?(c="iPhone",i="iOS"+r[2].replace(/_/g,".")):n?(c="iPad",i="iOS"+n[2].replace(/_/g,".")):o&&(c="iPod",i="iOS"+o[2].replace(/_/g,"."));var a=e.match(/MicroMessenger\/([\d\.]+)/i),s=!1,u="",l=!1;a&&a[1]&&(s=!0,u=a[1],"miniprogram"!==window.__wxjs_environment&&!/miniProgram/i.test(e)||(l=!0));var p=e.toLowerCase().match(/ nettype\/([^ ]+)/g),f="Unknown";return p&&p[0]&&(f=(p=p[0].split("/"))[1]),{system:c,systemVersion:i,netType:f,ua:e,wechat:s,wechatVersion:u,wechatMini:l}},getCookie:function(e){var o=encodeURIComponent(e).replace(/[-.+*]/g,"\\$&"),n=RegExp("(?:(?:^|.*;)\\s*".concat(o,"\\s*\\=\\s*([^;]*).*$)|^.*$"));return decodeURIComponent(document.cookie.replace(n,"$1"))||null},makeReport:function(e,o){var n=e;a(e,"String")&&(n=Error(e)),u.onReport.call(l,u.processStack(n),o||s.MANUAL)}};return["log","info","warn","debug","error"].forEach(function(e){var o=console[e];console[e]=function(){return c&&t.push({logType:e,logs:arguments}),o.apply(console,arguments)}}),l});
